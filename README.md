
# æ³•è— fazang ä¿®æ³•è¨˜æ•¸å™¨

ä¸€å€‹ç°¡æ½”å„ªé›…çš„ä½›æ•™æŒå’’è¨ˆæ•¸æ‡‰ç”¨ï¼Œå¹«åŠ©æ‚¨è¿½è¹¤å’Œç®¡ç†æ¯æ—¥ä¿®è¡Œé€²åº¦ã€‚

## åŠŸèƒ½ç‰¹è‰²

- âœ¨ **å’’èªç®¡ç†**ï¼šæ–°å¢ã€ç·¨è¼¯å’Œç®¡ç†å¤šå€‹å’’èªé …ç›®
- ğŸ“Š **è¨ˆæ•¸è¿½è¹¤**ï¼šè¨˜éŒ„æ¯æ¬¡æŒå’’çš„æ¬¡æ•¸ï¼Œæ”¯æ´å¿«é€Ÿè¨ˆæ•¸èˆ‡ç¸½æ•¸é¡¯ç¤º
- ğŸ¯ **ç›®æ¨™è¨­å®š**ï¼šç‚ºæ¯å€‹å’’èªè¨­å®šæŒèª¦ç›®æ¨™ï¼Œé¡¯ç¤ºå®Œæˆé€²åº¦
- ğŸ“… **æœŸé–“çµ±è¨ˆ**ï¼šè¨­å®šæŒå’’æœŸé–“ï¼ˆèµ·è¨–æ—¥æœŸï¼‰ï¼ŒæŸ¥çœ‹æœŸé–“å…§çš„é€²åº¦èˆ‡ç´¯è¨ˆ
- ğŸ“Œ **ç½®é ‚åŠŸèƒ½**ï¼šå°‡é‡é»ä¿®æ³•é …ç›®ç½®é ‚é¡¯ç¤ºï¼Œæ–¹ä¾¿å„ªå…ˆè¨˜éŒ„
- ğŸ”„ **æ­¸é›¶åŠŸèƒ½**ï¼šé …ç›®å®Œæˆå¾Œå¯é‡ç½®è¨ˆæ•¸ï¼Œè‡ªå‹•è¨˜éŒ„åˆ°è©¦ç®—è¡¨
- ğŸ“– **æ­·å²ç´€éŒ„**ï¼šæŸ¥çœ‹å®Œæ•´çš„æŒå’’æ­·å²è¨˜éŒ„
- ğŸ‘¤ **å€‹äººè³‡æ–™**ï¼šè¨­å®šä¿®è¡Œè€…å§“åèˆ‡å°çµ„
- â˜ï¸ **é›²ç«¯åŒæ­¥**ï¼šæ”¯æ´ Google Sheets åŒæ­¥ï¼Œå¤šäººå…±ä¿®çµ±è¨ˆ
- ğŸ¨ **éš¨æ©Ÿé…è‰²**ï¼šæ¯å€‹é …ç›®è‡ªå‹•åˆ†é…æ·±è‰²è­˜åˆ¥è‰²ï¼Œä¾¿æ–¼è©¦ç®—è¡¨çµ±è¨ˆ
- ğŸ’¬ **å‹¸ä¸–æ³•èª**ï¼šéš¨æ©Ÿé¡¯ç¤ºä½›æ•™æ³•èªï¼Œå¢æ·»ä¿®è¡Œæ°›åœ
- ğŸŒ™ **æœ¬åœ°å„²å­˜**ï¼šæ‰€æœ‰è³‡æ–™å„²å­˜åœ¨æœ¬åœ°ç€è¦½å™¨ï¼Œä¿è­·æ‚¨çš„éš±ç§

## æŠ€è¡“æ¶æ§‹

- **æ¡†æ¶**ï¼šReact 19 + TypeScript
- **å»ºç½®å·¥å…·**ï¼šVite 6
- **æ¨£å¼**ï¼šTailwind CSS 4 + PostCSS
- **åœ–ç¤º**ï¼šLucide React
- **å„²å­˜**ï¼šLocalStorage API

## å®‰è£èˆ‡åŸ·è¡Œ

### å‰ç½®éœ€æ±‚

- Node.js 18+ 
- npm æˆ– yarn

### æœ¬åœ°é–‹ç™¼

1. å®‰è£ä¾è³´ï¼š
   ```bash
   npm install
   ```

2. å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ï¼š
   ```bash
   npm run dev
   ```

3. åœ¨ç€è¦½å™¨é–‹å•Ÿ `http://localhost:3000`

### å»ºç½®ç”Ÿç”¢ç‰ˆæœ¬

```bash
npm run build
```

å»ºç½®å®Œæˆå¾Œï¼Œç”¢å‡ºæª”æ¡ˆæœƒåœ¨ `dist` ç›®éŒ„ä¸­ã€‚

### é è¦½ç”Ÿç”¢ç‰ˆæœ¬

```bash
npm run preview
```

## å°ˆæ¡ˆçµæ§‹

```
fazang/
â”œâ”€â”€ components/          # React å…ƒä»¶
â”‚   â”œâ”€â”€ BuddhaHeader.tsx         # é ‚éƒ¨èƒŒæ™¯èˆ‡æ³•èªé¡¯ç¤º
â”‚   â”œâ”€â”€ DateSettingModal.tsx     # æœŸé–“è¨­å®šè¦–çª—
â”‚   â”œâ”€â”€ EditMantraModal.tsx      # ç·¨è¼¯é …ç›®è¦–çª—
â”‚   â”œâ”€â”€ HistoryView.tsx          # æ­·å²ç´€éŒ„æª¢è¦–
â”‚   â”œâ”€â”€ InputModal.tsx           # è¨ˆæ•¸è¼¸å…¥è¦–çª—
â”‚   â”œâ”€â”€ SheetSettingsModal.tsx   # Google Sheets è¨­å®š
â”‚   â””â”€â”€ UserModal.tsx            # ä½¿ç”¨è€…è³‡æ–™è¨­å®š
â”œâ”€â”€ services/           # æœå‹™å±¤
â”‚   â””â”€â”€ storage.ts      # LocalStorage èˆ‡ Google Sheets ç®¡ç†
â”œâ”€â”€ App.tsx             # ä¸»æ‡‰ç”¨å…ƒä»¶
â”œâ”€â”€ index.tsx           # æ‡‰ç”¨å…¥å£
â”œâ”€â”€ types.ts            # TypeScript å‹åˆ¥å®šç¾©
â”œâ”€â”€ constants.ts        # å¸¸æ•¸å®šç¾©ï¼ˆæ³•èªã€ä½›åƒåœ–ç‰‡ï¼‰
â”œâ”€â”€ index.css           # å…¨åŸŸæ¨£å¼èˆ‡ Tailwind è¨­å®š
â””â”€â”€ vite.config.ts      # Vite é…ç½®
```

## éƒ¨ç½²

æ­¤æ‡‰ç”¨ç‚ºç´”å‰ç«¯å°ˆæ¡ˆï¼Œå¯éƒ¨ç½²è‡³ä»»ä½•éœæ…‹ç¶²ç«™è¨—ç®¡æœå‹™ï¼š

- **GitHub Pages**ï¼šå·²é…ç½®è‡ªå‹•éƒ¨ç½² workflow
- **Vercel**ï¼š`vercel --prod`
- **Netlify**ï¼šæ‹–æ”¾ `dist` ç›®éŒ„
- **å…¶ä»–**ï¼šä¸Šå‚³ `dist` ç›®éŒ„è‡³ä»»ä½•éœæ…‹ä¼ºæœå™¨

### GitHub Pages éƒ¨ç½²

å°ˆæ¡ˆå·²é…ç½® GitHub Actions è‡ªå‹•éƒ¨ç½²ï¼š

```bash
npm run build
git add .
git commit -m "Update"
git push
```

æ¨é€å¾Œæœƒè‡ªå‹•è§¸ç™¼ `.github/workflows/deploy.yml`ï¼Œå°‡å»ºç½®çµæœéƒ¨ç½²åˆ° GitHub Pagesã€‚

## Google Sheets åŒæ­¥è¨­å®š

1. é–‹å•Ÿ Google è©¦ç®—è¡¨
2. å»ºç«‹äº”å€‹åˆ†é ï¼Œåç¨±åˆ†åˆ¥ç‚ºï¼š
   - **ç¬¬ä¸€çµ„** (sheet1) - å°å—ä¸€çµ„çš„ç²¾ç°¡è³‡æ–™ï¼ˆå»é‡å¾Œï¼‰
   - **ç¬¬äºŒçµ„** (sheet2) - å°å—äºŒçµ„çš„ç²¾ç°¡è³‡æ–™ï¼ˆå»é‡å¾Œï¼‰
   - **ç¬¬ä¸‰çµ„** (sheet3) - å°å—ä¸‰çµ„çš„ç²¾ç°¡è³‡æ–™ï¼ˆå»é‡å¾Œï¼‰
   - **ç¬¬å››çµ„** (sheet4) - å°å—å››çµ„çš„ç²¾ç°¡è³‡æ–™ï¼ˆå»é‡å¾Œï¼‰
   - **ç´€éŒ„** (sheet5) - æ‰€æœ‰çµ„åˆ¥çš„å®Œæ•´æ­·å²è¨˜éŒ„ï¼ˆä¸å»é‡ï¼‰
3. é»é¸ã€Œæ“´å……åŠŸèƒ½ã€â†’ã€ŒApps Scriptã€
4. è²¼ä¸Šä»¥ä¸‹ç¨‹å¼ç¢¼ï¼š

```javascript
function doPost(e) {
  try {
    const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
    const payload = JSON.parse(e.postData.contents);
    
    if (payload.action === 'ADD_LOG') {
      const data = payload.data;
      const userName = payload.userName || '';
      const userGroup = payload.userGroup || '';
      
      // 1. å…ˆå¯«å…¥ Sheet5ã€Œç´€éŒ„ã€åˆ†é ï¼ˆå®Œæ•´æ­·å²è¨˜éŒ„ï¼‰
      writeToRecordSheet(spreadsheet, data, userName, userGroup);
      
      // 2. å†å¯«å…¥å°æ‡‰çš„çµ„åˆ¥åˆ†é ï¼ˆå»é‡è™•ç†ï¼‰
      writeToGroupSheet(spreadsheet, data, userName, userGroup);
    }
    
    return ContentService.createTextOutput(JSON.stringify({
      status: 'success'
    })).setMimeType(ContentService.MimeType.JSON);
    
  } catch (error) {
    Logger.log('Error: ' + error.toString());
    return ContentService.createTextOutput(JSON.stringify({
      status: 'error',
      message: error.toString()
    })).setMimeType(ContentService.MimeType.JSON);
  }
}

// å¯«å…¥ Sheet5ã€Œç´€éŒ„ã€åˆ†é ï¼ˆå®Œæ•´æ­·å²ï¼Œä¸å»é‡ï¼‰
function writeToRecordSheet(spreadsheet, data, userName, userGroup) {
  let recordSheet = spreadsheet.getSheetByName('ç´€éŒ„');
  if (!recordSheet) {
    recordSheet = spreadsheet.insertSheet('ç´€éŒ„');
  }
  
  // åˆå§‹åŒ–æ¨™é¡Œåˆ—
  if (recordSheet.getLastRow() === 0) {
    initializeSheet(recordSheet);
  }
  
  // ç›´æ¥è¿½åŠ è¨˜éŒ„
  recordSheet.appendRow([
    data.timestamp,
    userName,
    userGroup,
    data.mantraName,
    data.amount,
    data.totalCount
  ]);
  
  const rowIndex = recordSheet.getLastRow();
  formatRow(recordSheet, rowIndex, data.color);
}

// å¯«å…¥çµ„åˆ¥åˆ†é ï¼ˆå»é‡è™•ç†ï¼‰
function writeToGroupSheet(spreadsheet, data, userName, userGroup) {
  // æ ¹æ“šçµ„åˆ¥é¸æ“‡å°æ‡‰çš„åˆ†é 
  let sheetName = 'ç¬¬ä¸€çµ„'; // é è¨­
  
  if (userGroup.includes('ä¸€çµ„')) {
    sheetName = 'ç¬¬ä¸€çµ„';
  } else if (userGroup.includes('äºŒçµ„')) {
    sheetName = 'ç¬¬äºŒçµ„';
  } else if (userGroup.includes('ä¸‰çµ„')) {
    sheetName = 'ç¬¬ä¸‰çµ„';
  } else if (userGroup.includes('å››çµ„')) {
    sheetName = 'ç¬¬å››çµ„';
  }
  
  // å–å¾—æˆ–å»ºç«‹å°æ‡‰çš„åˆ†é 
  let sheet = spreadsheet.getSheetByName(sheetName);
  if (!sheet) {
    sheet = spreadsheet.insertSheet(sheetName);
  }
  
  // åˆå§‹åŒ–æ¨™é¡Œåˆ—
  if (sheet.getLastRow() === 0) {
    initializeSheet(sheet);
  }
  
  // å»é‡é‚è¼¯ï¼šæª¢æŸ¥æ˜¯å¦å­˜åœ¨ç›¸åŒçš„ã€Œé …ç›®åç¨±ã€å§“åã€çµ„åˆ¥ã€
  const lastRow = sheet.getLastRow();
  let existingRowIndex = -1;
  
  if (lastRow > 1) { // æœ‰è³‡æ–™è¡Œï¼ˆæ’é™¤æ¨™é¡Œåˆ—ï¼‰
    const allData = sheet.getRange(2, 1, lastRow - 1, 4).getValues();
    
    // å¾å¾Œå¾€å‰æœå°‹ï¼ˆå› ç‚ºç›¸åŒé …ç›®é€šå¸¸åœ¨ä¸‹æ–¹ï¼‰
    for (let i = allData.length - 1; i >= 0; i--) {
      const row = allData[i];
      const rowUserName = row[1];      // Bæ¬„ï¼šä½¿ç”¨è€…åç¨±
      const rowUserGroup = row[2];     // Cæ¬„ï¼šå°çµ„
      const rowMantraName = row[3];    // Dæ¬„ï¼šé …ç›®åç¨±
      
      if (rowUserName === userName && 
          rowUserGroup === userGroup && 
          rowMantraName === data.mantraName) {
        existingRowIndex = i + 2; // +2 æ˜¯å› ç‚ºé™£åˆ—å¾0é–‹å§‹ï¼Œä¸”ç¬¬1åˆ—æ˜¯æ¨™é¡Œ
        break;
      }
    }
  }
  
  if (existingRowIndex > 0) {
    // æ‰¾åˆ°ç›¸åŒè¨˜éŒ„ï¼Œæ›´æ–°è©²åˆ—
    sheet.getRange(existingRowIndex, 1, 1, 6).setValues([[
      data.timestamp,
      userName,
      userGroup,
      data.mantraName,
      data.amount,
      data.totalCount
    ]]);
    formatRow(sheet, existingRowIndex, data.color);
  } else {
    // æ²’æœ‰æ‰¾åˆ°ï¼Œæ–°å¢ä¸€ç­†
    sheet.appendRow([
      data.timestamp,
      userName,
      userGroup,
      data.mantraName,
      data.amount,
      data.totalCount
    ]);
    const rowIndex = sheet.getLastRow();
    formatRow(sheet, rowIndex, data.color);
  }
}

// åˆå§‹åŒ–å·¥ä½œè¡¨ï¼ˆè¨­å®šæ¨™é¡Œåˆ—ï¼‰
function initializeSheet(sheet) {
  sheet.appendRow(['æ™‚é–“', 'ä½¿ç”¨è€…åç¨±', 'å°çµ„', 'é …ç›®åç¨±', 'è®Šå‹•å€¼', 'é …ç›®ç•¶å‰ç¸½æ•¸']);
  const headerRange = sheet.getRange(1, 1, 1, 6);
  headerRange.setFontWeight('bold');
  headerRange.setFontColor('#000000');
  headerRange.setHorizontalAlignment('center');
  
  // å‡çµæ¨™é¡Œåˆ—
  sheet.setFrozenRows(1);
  
  // è¨­å®šæ¬„ä½å¯¬åº¦
  sheet.setColumnWidth(1, 150); // æ™‚é–“
  sheet.setColumnWidth(2, 100); // ä½¿ç”¨è€…åç¨±
  sheet.setColumnWidth(3, 100); // å°çµ„
  sheet.setColumnWidth(4, 200); // é …ç›®åç¨±
  sheet.setColumnWidth(5, 80);  // è®Šå‹•å€¼
  sheet.setColumnWidth(6, 120); // é …ç›®ç•¶å‰ç¸½æ•¸
}

// æ ¼å¼åŒ–åˆ—æ¨£å¼
function formatRow(sheet, rowIndex, color) {
  const rowRange = sheet.getRange(rowIndex, 1, 1, 6);
  rowRange.setFontColor('#000000');
  // æ‰€æœ‰å…§å®¹ç½®ä¸­å°é½Š
  rowRange.setHorizontalAlignment('center');
  rowRange.setVerticalAlignment('middle');
  
  // è‡ªå‹•èª¿æ•´åˆ—é«˜
  sheet.setRowHeight(rowIndex, 25);
}

// æ¸¬è©¦å‡½æ•¸ï¼ˆå¯é¸ï¼‰
function testDoPost() {
  const testPayload = {
    action: 'ADD_LOG',
    userName: 'æ¸¬è©¦ç”¨æˆ¶',
    userGroup: 'å°å—ä¸€çµ„',
    data: {
      timestamp: '2025/12/21 14:30',
      mantraName: 'æ‡·æ¥­ç¥ˆç¦±æ–‡',
      amount: '+108',
      totalCount: 1080,
      color: '#8B4513'
    }
  };
  
  const testEvent = {
    postData: {
      contents: JSON.stringify(testPayload)
    }
  };
  
  const result = doPost(testEvent);
  Logger.log(result.getContent());
}
```

5. éƒ¨ç½²ç‚ºç¶²é æ‡‰ç”¨ç¨‹å¼ï¼ˆåŸ·è¡Œèº«åˆ†ï¼šæˆ‘ï¼Œå­˜å–æ¬Šé™ï¼šä»»ä½•äººï¼‰
6. è¤‡è£½éƒ¨ç½²ç¶²å€
7. åœ¨æ‡‰ç”¨ä¸­é»é¸è¨­å®šï¼Œè²¼ä¸Šç¶²å€

### åˆ†é èªªæ˜

ç³»çµ±æœƒè‡ªå‹•å°‡è³‡æ–™å¯«å…¥å°æ‡‰çš„åˆ†é ï¼š

#### çµ„åˆ¥åˆ†é ï¼ˆSheet1-4ï¼‰- ç²¾ç°¡é¡¯ç¤ºï¼ˆå»é‡ï¼‰
- **å°å—ä¸€çµ„** â†’ ç¬¬ä¸€çµ„ (sheet1)
- **å°å—äºŒçµ„** â†’ ç¬¬äºŒçµ„ (sheet2)
- **å°å—ä¸‰çµ„** â†’ ç¬¬ä¸‰çµ„ (sheet3)
- **å°å—å››çµ„** â†’ ç¬¬å››çµ„ (sheet4)

**å»é‡é‚è¼¯**ï¼šç•¶ã€Œé …ç›®åç¨±ã€ã€ã€Œå§“åã€ã€ã€Œçµ„åˆ¥ã€é€™ä¸‰å€‹æ¬„ä½éƒ½ç›¸åŒæ™‚ï¼Œåªä¿ç•™æœ€æ–°çš„ä¸€ç­†è³‡æ–™ï¼ˆè¦†è“‹èˆŠè³‡æ–™ï¼‰ã€‚é€™æ¨£å¯ä»¥è®“å„çµ„åˆ¥åˆ†é ä¿æŒç²¾ç°¡ï¼Œå¿«é€ŸæŸ¥çœ‹æ¯å€‹äººæ¯å€‹é …ç›®çš„æœ€æ–°ç‹€æ…‹ã€‚

#### ç´€éŒ„åˆ†é ï¼ˆSheet5ï¼‰- å®Œæ•´æ­·å²
- **ç´€éŒ„** (sheet5) - ä¿å­˜æ‰€æœ‰çµ„åˆ¥çš„å®Œæ•´æ­·å²è¨˜éŒ„

**å®Œæ•´è¨˜éŒ„**ï¼šæ‰€æœ‰çš„æ“ä½œéƒ½æœƒå®Œæ•´ä¿å­˜åœ¨æ­¤åˆ†é ï¼Œä¸é€²è¡Œä»»ä½•å»é‡è™•ç†ã€‚å³ä½¿åœ¨çµ„åˆ¥åˆ†é ä¸­è¢«è¦†è“‹çš„è³‡æ–™ï¼Œåœ¨æ­¤åˆ†é ä¸­ä»ç„¶å®Œæ•´ä¿ç•™ï¼Œé¿å…å› èª¤æ“ä½œå°è‡´è³‡æ–™éºå¤±ã€‚

**é è¨­è¡Œç‚º**ï¼šå¦‚æœä½¿ç”¨è€…æœªè¨­å®šçµ„åˆ¥ï¼Œè³‡æ–™å°‡é è¨­å¯«å…¥ã€Œç¬¬ä¸€çµ„ã€åˆ†é ã€‚

### å°çµ„ä½¿ç”¨æ–¹å¼

å»ºç«‹åŒ…å«è©¦ç®—è¡¨è¨­å®šçš„é€£çµï¼š
```
https://your-domain.com/?script=APPS_SCRIPT_URL&group=GROUP_NAME
```

æˆå“¡å¾æ­¤é€£çµé€²å…¥å¾Œï¼Œå¯å°‡é é¢åŠ åˆ°ä¸»ç•«é¢ï¼Œä¹‹å¾Œå¾æ¡Œé¢é–‹å•Ÿå³è‡ªå‹•é€£çµè©¦ç®—è¡¨ã€‚

## æˆæ¬Š

MIT License

## è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼
